/*!
 * Claudio Sanches - Correios for WooCommerce: Autofill Brazilian 2016.
 *
 * Autofill address with postcodes.
 *
 * Version: 3.0.0
 */
jQuery(function($){var WCCorreiosAutofillAddress={init:function(){this.autofill('billing',true);$(document.body).on('blur','#billing_postcode',function(){WCCorreiosAutofillAddress.autofill('billing')});$(document.body).on('blur','#shipping_postcode',function(){WCCorreiosAutofillAddress.autofill('shipping')})},block:function(){$('form.checkout, form#order_review').addClass('processing').block({message:null,overlayCSS:{background:'#fff',opacity:0.6}})},unblock:function(){$('form.checkout, form#order_review').removeClass('processing').unblock()},autofill:function(field,copy){copy=copy||false;if($('#'+field+'_postcode').length){var cep=$('#'+field+'_postcode').val().replace('.','').replace('-',''),country=$('#'+field+'_country').val(),address_1=$('#'+field+'_address_1').val(),override=('yes'===WCCorreiosAutofillAddressParams.force)?true:(0===address_1.length);if(cep!==''&&8===cep.length&&'BR'===country&&override){WCCorreiosAutofillAddress.block();$.ajax({type:'GET',url:WCCorreiosAutofillAddressParams.url+'&postcode='+cep,dataType:'json',contentType:'application/json',success:function(address){if(address.success){WCCorreiosAutofillAddress.fillFields(field,address.data);if(copy){var newField='billing'===field?'shipping':'billing';WCCorreiosAutofillAddress.fillFields(newField,address.data)}}WCCorreiosAutofillAddress.unblock()}})}}},fillFields:function(field,data){console.log(data);$('#'+field+'_address_1').val(data.address).change();if($('#'+field+'_neighborhood').length){$('#'+field+'_neighborhood').val(data.neighborhood).change()}else{$('#'+field+'_address_2').val(data.neighborhood).change()}$('#'+field+'_city').val(data.city).change();$('#'+field+'_state').val(data.state).change()}};WCCorreiosAutofillAddress.init()});
